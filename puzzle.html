<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Complex Password Game</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet" />
  <style>
    body {
      background: linear-gradient(to right, #74ebd5, #ACB6E5);
      font-family: 'Noto Sans KR', sans-serif;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 700px;
      margin: 50px auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    header {
      text-align: center;
      margin-bottom: 20px;
    }
    header h1 {
      margin: 0;
      font-size: 28px;
      color: #333;
    }
    header p {
      margin: 5px 0 15px;
      color: #555;
    }
    #basic-hints {
      background: #e0f7fa;
      border: 1px solid #4caf50;
      border-radius: 5px;
      padding: 10px;
      margin-bottom: 10px;
      font-size: 14px;
      line-height: 1.5;
      color: #333;
    }
    #status-bar {
      font-size: 14px;
      margin-bottom: 10px;
      text-align: center;
      color: #333;
    }
    #game-output {
      background: #fafafa;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 10px;
      min-height: 150px;
      margin-bottom: 20px;
      white-space: pre-wrap;
      font-size: 14px;
      max-height: 200px;
      overflow-y: auto;
    }
    #game-input {
      width: calc(100% - 22px);
      padding: 10px;
      font-size: 16px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    #char-count {
      color: red;
      font-weight: bold;
      margin-left: 10px;
    }
    .buttons {
      text-align: center;
      margin-top: 10px;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
    }
    #submit-button {
      background: #4caf50;
      color: #fff;
    }
    #submit-button:hover {
      background: #45a049;
    }
    #giveup-button {
      background: #f44336;
      color: #fff;
    }
    #giveup-button:hover {
      background: #da190b;
    }
    #hint-button {
      background: #2196f3;
      color: #fff;
    }
    #hint-button:hover {
      background: #0b7dda;
    }
    #restart-button {
      background: #ffc107;
      color: #fff;
    }
    #restart-button:hover {
      background: #ffb300;
    }
    #home-button {
      background: #e53935; /* ë¹¨ê°„ìƒ‰ ë°°ê²½ */
      color: #fff;
    }
    #home-button:hover {
      background: #d32f2f;
    }
    select {
      padding: 5px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Complex Password Game</h1>
      <p>ë¹„ë°€ë²ˆí˜¸ë¥¼ ë§ì¶°ë³´ì„¸ìš”!</p>
      <label for="difficulty-select">ë‚œì´ë„ ì„ íƒ: </label>
      <select id="difficulty-select">
        <option value="ì‰¬ì›€">ì‰¬ì›€</option>
        <option value="ë³´í†µ" selected>ë³´í†µ</option>
        <option value="ì–´ë ¤ì›€">ì–´ë ¤ì›€</option>
      </select>
    </header>

    <!-- ê¸°ë³¸ íŒíŠ¸ ì˜ì—­ -->
    <div id="basic-hints"></div>
    <!-- ìƒíƒœ í‘œì‹œ (ì‹œë„ íšŸìˆ˜, ê²½ê³¼ ì‹œê°„, ìŠ¹/íŒ¨ ê¸°ë¡) -->
    <div id="status-bar"></div>

    <div id="game-output">
      <!-- ê²Œì„ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤ -->
    </div>
    <input type="text" id="game-input" placeholder="ì¶”ì¸¡ì„ ì…ë ¥í•˜ì„¸ìš”..." />
    <span id="char-count"></span>
    <div class="buttons">
      <button id="submit-button">ì œì¶œ</button>
      <button id="giveup-button">í¬ê¸°</button>
      <button id="hint-button">íŒíŠ¸</button>
      <button id="restart-button" style="display: none;">ì¬ì‹œì‘</button>
      <button id="home-button" style="display: none;">ğŸ </button>
    </div>
  </div>

  <script>
    // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
    const gameOutput = document.getElementById('game-output');
    const gameInput = document.getElementById('game-input');
    const submitButton = document.getElementById('submit-button');
    const giveupButton = document.getElementById('giveup-button');
    const hintButton = document.getElementById('hint-button');
    const restartButton = document.getElementById('restart-button');
    const homeButton = document.getElementById('home-button');
    const difficultySelect = document.getElementById('difficulty-select');
    const basicHintsDiv = document.getElementById('basic-hints');
    const charCountSpan = document.getElementById('char-count');
    const statusBarDiv = document.getElementById('status-bar');

    let selectedPassword = "";
    let currentConfig = null;
    let attemptCount = 0;
    let extraHints = [];
    let timerInterval;
    let startTime;
    let winCount = 0;
    let lossCount = 0;

    /* 
      ë‚œì´ë„ë³„ ì„¤ì •  
      - ì‰¬ì›€: 8ê¸€ì, ì˜ì–´ ë‹¨ì–´(ì˜ˆ: apple, orange ë“±) + ìˆ«ì (ëŒ€ì†Œë¬¸ì í˜¼í•©)
      - ë³´í†µ: 10ê¸€ì, ì˜ì–´ ë‹¨ì–´(ì˜ˆ: apple, mango ë“±) + ìˆ«ì ë° íŠ¹ìˆ˜ë¬¸ì
      - ì–´ë ¤ì›€: 12ê¸€ì, í•œê¸€ ë‹¨ì–´(ì˜ˆ: í–‰ë³µ, ì¶©ì „ê¸° ë“±) + ìˆ«ì ë° íŠ¹ìˆ˜ë¬¸ì
    */
    const difficultyConfigs = {
      "ì‰¬ì›€": {
        length: 8,
        baseWords: ["apple", "orange", "banana", "peach", "grape"],
        fillerSet: "0123456789",
        language: "en",
        composition: "ì˜ì–´(ëŒ€ì†Œë¬¸ì)ì™€ ìˆ«ì"
      },
      "ë³´í†µ": {
        length: 10,
        baseWords: ["apple", "mango", "papaya", "cherry", "lemon"],
        fillerSet: "0123456789!@#$%^&*",
        language: "en",
        composition: "ì˜ì–´(ëŒ€ì†Œë¬¸ì), ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì"
      },
      "ì–´ë ¤ì›€": {
        length: 12,
        baseWords: ["í–‰ë³µ", "ì¶©ì „ê¸°", "ì‚¬ë‘", "ê¸°ì¨", "í¬ë§", "ë„ì „", "ì„±ê³µ"],
        fillerSet: "0123456789!@#$%^&*",
        language: "ko",
        composition: "í•œê¸€, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì"
      }
    };

    // ì‹¤ì œ ë‹¨ì–´(ê¸°ë°˜ ë‹¨ì–´)ë¥¼ ì´ìš©í•˜ì—¬ ë¹„ë°€ë²ˆí˜¸ ìƒì„± í•¨ìˆ˜
    function generatePassword(config) {
      let baseWord = config.baseWords[Math.floor(Math.random() * config.baseWords.length)];
      if (config.language === "en") {
        baseWord = Array.from(baseWord)
          .map(char => (Math.random() < 0.5 ? char.toLowerCase() : char.toUpperCase()))
          .join('');
      }
      let remain = config.length - baseWord.length;
      let filler = "";
      for (let i = 0; i < remain; i++) {
        filler += config.fillerSet.charAt(Math.floor(Math.random() * config.fillerSet.length));
      }
      return baseWord + filler;
    }

    // ì¶”ê°€ íŒíŠ¸ ìƒì„± í•¨ìˆ˜ (íŒíŠ¸ ë²„íŠ¼ ì „ìš©)
    function generateExtraHints(password, config) {
      let hints = [];
      hints.push(`ë¹„ë°€ë²ˆí˜¸ì˜ ë‘ ë²ˆì§¸ ê¸€ìëŠ” "${password[1]}" ì…ë‹ˆë‹¤.`);
      hints.push(`ë¹„ë°€ë²ˆí˜¸ì— ì‚¬ìš©ëœ ìˆ«ìê°€ ìµœì†Œ 1ê°œ ì´ìƒ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.`);
      if (config.fillerSet.match(/[^0-9]/)) {
        hints.push(`ë¹„ë°€ë²ˆí˜¸ì— íŠ¹ìˆ˜ë¬¸ìê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
      }
      return hints;
    }

    // ê¸°ë³¸ íŒíŠ¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateBasicHints() {
      if (!selectedPassword || !currentConfig) return;
      const len = currentConfig.length;
      const first = selectedPassword[0];
      const last = selectedPassword[selectedPassword.length - 1];
      let mid = "";
      if (selectedPassword.length % 2 === 1) {
        mid = selectedPassword[Math.floor(selectedPassword.length / 2)];
      } else {
        mid =
          selectedPassword[selectedPassword.length / 2 - 1] +
          selectedPassword[selectedPassword.length / 2];
      }
      basicHintsDiv.innerHTML = `
        <strong>ê¸°ë³¸ íŒíŠ¸:</strong><br>
        - ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´: ${len}ê¸€ì<br>
        - êµ¬ì„±: ${currentConfig.composition}<br>
        - ì²« ê¸€ì: ${first}<br>
        - ì¤‘ê°„ ê¸€ì: ${mid}<br>
        - ë§ˆì§€ë§‰ ê¸€ì: ${last}
      `;
    }

    // íƒ€ì´ë¨¸ ë° ìƒíƒœë°” ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateStatusBar() {
      const elapsedTime = Math.floor((new Date() - startTime) / 1000);
      const minutes = Math.floor(elapsedTime / 60);
      const seconds = elapsedTime % 60;
      statusBarDiv.innerHTML = `ì‹œë„ íšŸìˆ˜: ${attemptCount} &nbsp;&nbsp; ê²½ê³¼ ì‹œê°„: ${minutes}ë¶„ ${seconds}ì´ˆ &nbsp;&nbsp; ìŠ¹: ${winCount} / íŒ¨: ${lossCount}`;
    }

    function startTimer() {
      startTime = new Date();
      timerInterval = setInterval(updateStatusBar, 1000);
    }

    // ë‚¨ì€ ê¸€ì ìˆ˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateCharCount() {
      if (currentConfig) {
        let remaining = currentConfig.length - gameInput.value.length;
        if (remaining < 0) remaining = 0;
        charCountSpan.textContent = `ë‚¨ì€ ê¸€ì: ${remaining}`;
      } else {
        charCountSpan.textContent = "";
      }
    }

    // ê²Œì„ ì´ˆê¸°í™” í•¨ìˆ˜
    function initGame() {
      const difficulty = difficultySelect.value;
      currentConfig = difficultyConfigs[difficulty];
      selectedPassword = generatePassword(currentConfig);
      attemptCount = 0;
      extraHints = generateExtraHints(selectedPassword, currentConfig);
      gameOutput.innerHTML = `ìƒˆ ê²Œì„ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.
ë‚œì´ë„: ${difficulty} (ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´: ${currentConfig.length})
ë¹„ë°€ë²ˆí˜¸ëŠ” ${currentConfig.composition}ê°€ í¬í•¨ë©ë‹ˆë‹¤.
ê¸°ë³¸ íŒíŠ¸ëŠ” ìœ„ì— í‘œì‹œë˜ì–´ ìˆìŠµë‹ˆë‹¤.
-------------------------------------------------\n`;
      updateBasicHints();
      gameInput.value = "";
      gameInput.disabled = false;
      submitButton.disabled = false;
      giveupButton.disabled = false;
      hintButton.disabled = false;
      restartButton.style.display = "none";
      homeButton.style.display = "none";
      difficultySelect.disabled = true;
      updateCharCount();
      startTimer();
      updateStatusBar();
      gameInput.focus();
      console.log("ì •ë‹µ:", selectedPassword); // ê°œë°œììš© ì½˜ì†” ì¶œë ¥
    }

    // í”Œë ˆì´ì–´ì˜ ì¶”ì¸¡ ê²€ì‚¬ í•¨ìˆ˜
    function checkGuess(guess) {
      if (guess.length !== currentConfig.length) {
        gameOutput.innerHTML += `ì…ë ¥í•œ ë‹¨ì–´ì˜ ê¸¸ì´ê°€ ë‹¤ë¦…ë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ëŠ” ${currentConfig.length}ê¸€ìì…ë‹ˆë‹¤.\n`;
        return;
      }
      attemptCount++;
      // ì •í™•í•œ ìœ„ì¹˜ ì¼ì¹˜ ê°œìˆ˜
      let exactMatches = 0;
      for (let i = 0; i < guess.length; i++) {
        if (guess[i] === selectedPassword[i]) {
          exactMatches++;
        }
      }
      // ì „ì²´ í¬í•¨ëœ ë¬¸ì ê°œìˆ˜ (ì¤‘ë³µ ê³ ë ¤)
      const freqPassword = {};
      const freqGuess = {};
      for (let char of selectedPassword) {
        freqPassword[char] = (freqPassword[char] || 0) + 1;
      }
      for (let char of guess) {
        freqGuess[char] = (freqGuess[char] || 0) + 1;
      }
      let totalMatches = 0;
      for (let char in freqGuess) {
        if (freqPassword[char]) {
          totalMatches += Math.min(freqGuess[char], freqPassword[char]);
        }
      }
      let misplacedMatches = totalMatches - exactMatches;
      gameOutput.innerHTML += `[ì‹œë„ ${attemptCount}] ì¶”ì¸¡: "${guess}" â†’ ì •í™•í•œ ìœ„ì¹˜: ${exactMatches}, í¬í•¨(ìœ„ì¹˜ ë¶ˆì¼ì¹˜): ${misplacedMatches}\n`;
      updateStatusBar();
      if (guess === selectedPassword) {
        gameOutput.innerHTML += `\nì¶•í•˜í•©ë‹ˆë‹¤! ì •ë‹µì…ë‹ˆë‹¤: ${selectedPassword}\n`;
        winCount++;
        endGame();
      }
      gameOutput.scrollTop = gameOutput.scrollHeight;
    }

    // ê²Œì„ ì¢…ë£Œ ì²˜ë¦¬ í•¨ìˆ˜
    function endGame() {
      clearInterval(timerInterval);
      gameInput.disabled = true;
      submitButton.disabled = true;
      giveupButton.disabled = true;
      hintButton.disabled = true;
      restartButton.style.display = "inline-block";
      homeButton.style.display = "inline-block";
      difficultySelect.disabled = false;
      updateStatusBar();
    }

    // ì œì¶œ ë²„íŠ¼ ì´ë²¤íŠ¸
    submitButton.addEventListener('click', function() {
      const userGuess = gameInput.value.trim();
      if (userGuess === "") return;
      checkGuess(userGuess);
      gameInput.value = "";
      gameInput.focus();
      updateCharCount();
    });

    // ì—”í„°í‚¤ ì œì¶œ ì²˜ë¦¬
    gameInput.addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        event.preventDefault();
        submitButton.click();
      }
    });

    // ì…ë ¥ ì‹œ ë‚¨ì€ ê¸€ì ìˆ˜ ì—…ë°ì´íŠ¸
    gameInput.addEventListener("input", updateCharCount);

    // í¬ê¸° ë²„íŠ¼: ì •ë‹µ ê³µê°œ í›„ ê²Œì„ ì¢…ë£Œ (íŒ¨ë°° ì²˜ë¦¬)
    giveupButton.addEventListener('click', function() {
      gameOutput.innerHTML += `\ní¬ê¸°í•˜ì…¨ìŠµë‹ˆë‹¤. ì •ë‹µì€ "${selectedPassword}" ì…ë‹ˆë‹¤.\n`;
      lossCount++;
      endGame();
    });

    // íŒíŠ¸ ë²„íŠ¼: extraHints ë°°ì—´ì—ì„œ ë‚¨ì€ íŒíŠ¸ë¥¼ ë¬´ì‘ìœ„ë¡œ ì œê³µ
    hintButton.addEventListener('click', function() {
      if (extraHints.length > 0) {
        const index = Math.floor(Math.random() * extraHints.length);
        const hint = extraHints[index];
        gameOutput.innerHTML += `íŒíŠ¸: ${hint}\n`;
        extraHints.splice(index, 1);
      } else {
        gameOutput.innerHTML += `ë” ì´ìƒ íŒíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.\n`;
      }
      gameOutput.scrollTop = gameOutput.scrollHeight;
    });

    // ì¬ì‹œì‘ ë²„íŠ¼ ì´ë²¤íŠ¸
    restartButton.addEventListener('click', function() {
      clearInterval(timerInterval);
      initGame();
    });

    // ì§‘(í™ˆ) ë²„íŠ¼: index.htmlë¡œ ì´ë™
    homeButton.addEventListener('click', function() {
      window.location.href = "index.html";
    });

    // ê²Œì„ ì‹œì‘
    initGame();
  </script>
</body>
</html>
